<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
	<title></title>
	<link href="usdlc2.css" rel="stylesheet" type="text/css" />
</head>
<body>
<ul>
	<li>
	<h1>Roaster Client Support</h1>
	</li>
</ul>

<p>Roaster is designed to support single-page applications. To this end it provides:</p>

<ul>
	<li>Framework for compiling to browser supported formats. Out of the box Coffeescript to Javascript and Less to CSS are available.</li>
	<li>Package management and load-on-demand support for project and third-party code. Many prepared packages such as those for jquery, ckeditor and codemirror.</li>
	<li>A very very lightweight solution for separation of concerns providing the value of MVC without the overheads in both understanding and code.</li>
	<li>Simplified single-script installation for roaster and any system built with it. Works with OS-X, Linux and Windows.</li>
	<li>Common module support for sharing code between Node and the browser.</li>
</ul>

<p><textarea readonly="readonly" source="true" type="gwt.coffee">browser = gwt.browser()
gwt.open_page = (path = 'test/index.html') -&gt; gwt.preactions.push -&gt;
  url = "http://127.0.0.1:9009/#{path}"
  instance = browser.page('live')
  #instance.platform 'Google Chrome Canary'
  @page = instance.open url, retain: true
  @page.once 'open', =&gt; @next()
  @page.once 'error', =&gt; @fail()</textarea></p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span></div>

<h2>Initialisation</h2>

<p>Every project starts at <em>/index.html</em>. For a 'standard' roaster based project this is an empty document that loads&nbsp;/client/bootstrap.coffee to start the heavy lifting. This script initialises a requires keyword anc calls another roaster specific script <em>/client/bootstrap/init.coffee</em>. All if this is just preparation. A project specific <em>/client/app.coffee</em>&nbsp;prepares the application and loads the screen.</p>

<div class="metadata Ref">Ref: <span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.html',path:'../roaster/client/integrants/tab_view.html',category:'integrants'})">tab_view.html</a> </span></div>

<h2>Script and CSS Pre-compilation</h2>

<h2>Support</h2>

<h3>Page Arguments</h3>

<p>Page arguments provide controlled application operation from either the html or the search part of the url.</p>

<pre title="html" type="html">
&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;script&gt;
      roaster = {opts: {'test-arg': 23}}
    &lt;/script&gt;
    &lt;script src='/client/bootstrap.coffee?domain=client,library'&gt;
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

<p> </p>

<pre title="coffee" type="coffee">
gwt.open_page "gen/usdlc2/Roaster_Client_Support/"+
              "Support/Page_Arguments.html?test-arg2=45"
  
gwt.add "Embedded Page Arguments", -&gt; @page.test -&gt;
  usdlc2.check roaster.page_arg('test-arg'), '23'
  
gwt.add "Address Page Arguments", -&gt; @page.test -&gt;
  usdlc2.check roaster.page_arg('test-arg2'), '45'
  
gwt.add "Default Page Arguments", -&gt; @page.test -&gt;
  usdlc2.check roaster.page_arg('unknown', '12'), '12'</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h3>Important Elements</h3>

<p>Roaster keeps a reference to the head element in <em>roaster.head</em>. This is used for adding script and style elements to the document.</p>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add "Header Element", -&gt; @page.test -&gt;
  usdlc2.check roaster.head.nodeName, 'HEAD'</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h2>Sessions</h2>

<h3>Cookies</h3>

<p>Roaster provides a primative to set and/or get cookies from the browser conversation.</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><code>cookies = require 'http:/cookies'<br />
<br />
module.exports = (exchange) -&gt;<br />
&nbsp;&nbsp;my_name = cookies.get exchange.request, 'my_name'<br />
&nbsp;&nbsp;if my_name.length is 0<br />
&nbsp; &nbsp; my_name = 'Donald'<br />
&nbsp;&nbsp; &nbsp;cookies.set exchange.response, my_name: my_name</code><br />
 </div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<div class="metadata Ref">Ref: <span class="sessions"><a href="javascript:usdlc.edit_source({value:'sessions.coffee',path:'../roaster/server/boot/sessions.coffee',category:'boot'})">sessions.coffee</a> </span><span class="app"><a href="javascript:usdlc.edit_source({value:'app.coffee',path:'../roaster/app.coffee',category:'roaster'})">app.coffee</a> </span></div>

<h3>Sessions</h3>

<p>It is all very well for browser conversations to be completely stateless - most of the time. It does make sense, however, that when you log in that the server provides related state. Whenever roaster starts a conversation with a browser it adds a browser session cookie referencing a server side session object. In short, in any interaction, exchange.session can be used to store conversation data - until either the browser or server closes.</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><code>module.exports = (exchange) -&gt;<br />
&nbsp;&nbsp;exchange.session.counter ?= 0<br />
&nbsp;&nbsp;exchange.session.counter += 1<br />
&nbsp;&nbsp;exchange.respond.json counter: exchange.session.counter</code></div>

<h2>Package Management</h2>

<h3>Requires</h3>

<p>Roaster provides an extended version of the CommonJS approach to modules and package management. To support client/server common code and library code, the global require function can take a single module name and return a reference to the code.</p>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add -&gt;
  console.log "#2 CommonJS Requires"
  @page.test -&gt;
    util = require('util')
    usdlc2.test(util.isDate(new Date()))</pre>

<p>The downside is that if the module must be loaded from the server, a synchronous call will be needed - and will freeze the browser until completed. Given that most loads happen when accessing new functionality, and that roaster is designed for local network or same machine use, &nbsp;these freezes are both short and happen at a time when it should not be an annoyance.</p>

<p>Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span><span class="require"><a href="javascript:usdlc.edit_source({value:'require.coffee',path:'../roaster/drivers/require.coffee',category:'drivers'})">require.coffee</a> </span></p>

<h3>Module Path Conventions</h3>

<p>As with server files, <em>requires</em>&nbsp;searches well-known paths first on the target project and second on <em>roaster</em>. First it looks in <em>/client/</em>, then on the server paths, being <em>/common/, /server/ </em>and<em> /</em>.</p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.coffee',path:'../roaster/client/bootstrap.coffee',category:'client'})">bootstrap.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h3>Client Server Hybrid Modules</h3>

<p>It is often clearest to implement the two sides of a client/server communication in a single file. For this reason <em>module.exports.client</em> is used if it exists - otherwise <em>module.exports</em> is used as usual.</p>

<p>In the example, uSDLC2 executes which causes the test page to load (1) which in turn creates a requires to the server to (2).</p>

<pre title="coffee" type="coffee">
# (2) This code will be executed on the server
module.exports = (exchange) -&gt;
  exchange.respond.json server: 'called'

# (1) This code will be executed on the client
module.exports.client = -&gt;
  require.json "gen/usdlc2/Roaster_Client_Support/"+
  "Package_Management/Client_Server_Hybrid_Modules",
  (error, data_from_server) -&gt;
    usdlc2.check data_from_server.server, 'called'</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="init"><a href="javascript:usdlc.edit_source({value:'init.coffee',path:'../roaster/client/bootstrap/init.coffee',category:'bootstrap'})">init.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/bootstrap/loaders.coffee',category:'bootstrap'})">loaders.coffee</a>&nbsp;</span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.coffee',path:'../roaster/client/bootstrap.coffee',category:'client'})">bootstrap.coffee</a>&nbsp;</span><span class="require"><a href="javascript:usdlc.edit_source({value:'require.coffee',path:'../roaster/drivers/require.coffee',category:'drivers'})">require.coffee</a> </span><span class="driver"><a href="javascript:usdlc.edit_source({value:'driver.coffee',path:'../roaster/server/http/driver.coffee',category:'http'})">driver.coffee</a> </span><span class="script"><a href="javascript:usdlc.edit_source({value:'script.coffee',path:'../roaster/drivers/script.coffee',category:'drivers'})">script.coffee</a> </span><span class="server"><a href="javascript:usdlc.edit_source({value:'server.coffee',path:'../roaster/drivers/server.coffee',category:'drivers'})">server.coffee</a> </span><span class="respond"><a href="javascript:usdlc.edit_source({value:'respond.coffee',path:'../roaster/server/http/respond.coffee',category:'http'})">respond.coffee</a> </span><span class="create-http-server"><a href="javascript:usdlc.edit_source({value:'create-http-server.coffee',path:'../roaster/server/boot/create-http-server.coffee',category:'boot'})">create-http-server.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee">gwt.open_page "index.html"

gwt.add -&gt;
  console.log "#2 Client/Server Hybrid Module"
  @page.test -&gt;
    a = require "gen/usdlc2/Roaster_Client_Support/"+
    "Package_Management/Client_Server_Hybrid_Modules"
    a()
</textarea></p>

<h3>Basic Loading Support</h3>

<p>Require also provides facilities to load other forms of data from the server.</p>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>Scripts</h4>

<p>Use <em>require</em> to load modules from the current project. For external code, <em>requires.script(url, on_loaded)</em>&nbsp;provides basic asynchronous loading of JavaScript code by injecting <em>&lt;script&gt;</em> into the head element. The script is run on the browser by adding <em>domain=text/javascript</em> to the query. Use JSON, Text or Streamed below for scripts that run on the server.</p>

<pre title="coffee" type="coffee">
if gwt?.open_page
  gwt.open_page "index.html"

  gwt.add -&gt;
    console.log "#2 require.script(url, on_loaded)"
    @page.test -&gt;
      require.script "gen/usdlc2/"+
      "Roaster_Client_Support/Package_Management/"+
      "Basic_Loading_Support/Scripts.coffee", -&gt;

usdlc2.pass('this runs on client') if usdlc2?.pass</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="client"><a href="javascript:usdlc.edit_source({value:'client.coffee',path:'../roaster/drivers/client.coffee',category:'drivers'})">client.coffee</a> </span><span class="respond"><a href="javascript:usdlc.edit_source({value:'respond.coffee',path:'../roaster/server/http/respond.coffee',category:'http'})">respond.coffee</a> </span><span class="driver"><a href="javascript:usdlc.edit_source({value:'driver.coffee',path:'../roaster/server/http/driver.coffee',category:'http'})">driver.coffee</a> </span><span class="create-http-server"><a href="javascript:usdlc.edit_source({value:'create-http-server.coffee',path:'../roaster/server/boot/create-http-server.coffee',category:'boot'})">create-http-server.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span><span class="roast"><a href="javascript:usdlc.edit_source({value:'roast.coffee',path:'../roaster/client/roast.coffee',category:'client'})">roast.coffee</a> </span><span class="init"><a href="javascript:usdlc.edit_source({value:'init.coffee',path:'../roaster/client/roast/init.coffee',category:'roast'})">init.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>CSS</h4>

<p>CSS files can be added with requires.css(url) - which in turn creates a link element in the head. If the reference is to the local server, roaster provides translations from less and stylus to CSS. More can be added using the server-side morph system.</p>

<pre title="less" type="less">
@base: #f938ab;

.box-shadow(@style, @c) when (iscolor(@c)) {
  -webkit-box-shadow: @style @c;
  box-shadow:         @style @c;
}
.box-shadow(@style, @alpha: 50%) when (isnumber(@alpha)) {
  .box-shadow(@style, rgba(0, 0, 0, @alpha));
}
.box {
  float: right;
  color: saturate(@base, 5%);
  border-color: lighten(@base, 30%);
  div { .box-shadow(0 0 5px, 30%) }
}
</pre>

<p> </p>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add -&gt;
  console.log "#2 require.css(url)"
  @page.test -&gt;
    
    require.css "gen/usdlc2/"+
      "Roaster_Client_Support/Package_Management/"+
      "Basic_Loading_Support/CSS.less"
      
    document.body.innerHTML = "&lt;div class='box'&gt;a&lt;/div&gt;"
    div = document.getElementsByClassName('box')[0]
    # wait for css to load and take effect
    setTimeout (-&gt;
      left = div.offsetLeft
      usdlc2.test left &gt; 100, "Box is at "+left), 200</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.coffee',path:'../roaster/client/integrants/panel_stack.coffee',category:'integrants'})">panel_stack.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>JSON</h4>

<p>Data is often transferred between client and server in JSON format.</p>

<pre title="json" type="json">
{ "server-side": true }
</pre>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add -&gt;
  console.log "#2 require.json(url, on_loaded)"
  @page.test -&gt;
    require.json "gen/usdlc2/Roaster_Client_Support/"+
    "Package_Management/Basic_Loading_Support/JSON.json",
    (error, from_server) -&gt;
      usdlc2.test from_server["server-side"]</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>Data</h4>

<p>Sometimes it is easiest to parse proprietary formats on the client.</p>

<pre title="txt" type="txt">
Spanish rain</pre>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add -&gt;
  console.log "#2 require.data(url, on_loaded)"
  @page.test -&gt;
    require.data "gen/usdlc2/Roaster_Client_Support/"+
    "Package_Management/Basic_Loading_Support/Data.txt",
    (error, from_server) -&gt;
      rained = from_server.indexOf("Spanish rain")
      usdlc2.test rained isnt -1</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/bootstrap/loaders.coffee',category:'bootstrap'})">loaders.coffee</a> </span><span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>Streamed</h4>

<p>For absolute control of data from the server, use <em>require.stream(url, headers..., on_data)</em>.</p>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add -&gt;
  console.log "#2 require.stream"
  @page.test -&gt;
    data = []
    require.stream "gen/usdlc2/Roaster_Client_Support/"+
    "Package_Management/Basic_Loading_Support/Data.txt",
    pragma: "no-cache", (error, chunk, is_complete) -&gt;
      data.push chunk
      if is_complete
        data = data.join('')
        rained = data.indexOf("Spanish rain")
        usdlc2.test rained isnt -1</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/bootstrap/loaders.coffee',category:'bootstrap'})">loaders.coffee</a> </span><span class="files"><a href="javascript:usdlc.edit_source({value:'files.coffee',path:'../roaster/server/files.coffee',category:'server'})">files.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h2>VC - Separation of Concerns</h2>

<h3>Core VC</h3>

<h4>HTML View</h4>

<p>The model is the concern of the server and is connected by the controllers using <em>require.json</em> or <em>require.data</em>. The controller provides client side computation and retrieval of model information from the server. The view is comprised of HTML and Style fragments.</p>

<p>An integrant is the client side files that make up a single entity. All files have the same name. The view has a html and style file (css, less or stylus). The controller can be any language that compiles to Javascript (js, coffee, ...). The same file can include the server code to interface to the model.</p>

<p>Integrants are associated with a host element on the page. Different parts of a page can be serviced by instances of the same or different integrants. They can also be nested. Unit testing is supported by providing a mock host element.</p>

<p>An integrant is created with <em>roaster.mvc(host, opts..., &nbsp;on_ready)</em>. The host element attributes are added to the opts - and have the highest priority.&nbsp;The callback will be made when the html and scripts are both loaded and ready: <em>on_ready(error, integrant)</em>.</p>

<p>While the CSS is loaded as part of the integrant, the definitions are not in a separate namespace. For this example, the outer integrant is designed to fill the entire body area.</p>

<pre title="css" type="css">
.main {
  width: 100%;
  height: 100%;
}
.main .doc { background-color: red; }
.main .code { background-color: green; }
.main .windows { background-color: blue; }</pre>

<p>Normally you will use <em>class="fill_parent"</em>&nbsp;instead.The heading is for an example of html. Often an outer integrant is empty.</p>

<p>This example represents the view in HTML. This is fine for static views, but if we can add components dynamically, a code view would be more appropriate. Each of the examples below provide both.</p>

<pre title="html" type="html">
&lt;table class="vc main" vc="panel_stack" name="panel_stack_test"&gt;
  &lt;tr&gt;
    &lt;td class="doc" style="max-height:80%; height:50%"&gt;
      Document
    &lt;/td&gt;
  &lt;/tr&gt;&lt;tr class="resizable"&gt;
    &lt;td class="code" style="max-height:80%; height:50%"&gt;
      Code
    &lt;/td&gt;
  &lt;/tr&gt;&lt;tr&gt;
    &lt;td class="windows" style="height:2em"&gt;
      Window Tabs
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
&lt;div class="templates"&gt;
  &lt;div template="sample"&gt;
    Template content
    &lt;span class='container'&gt;this will be replaced&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>

<p>Anything with a class of <em>template</em> is recorded in the integrant array <em>@templates</em> - both as an array and by name if it has a name element. In the example above the single template can be retrieved as <em>@templates[0]</em> or <em>@templates.sample.&nbsp;</em>Once a template is captured it is removed from the DOM. In this example we don't use the template. It is available for repeating elements - see Panel Stack. Anything inside a template with a class of <em>container</em> will contain any inner integrants.</p>

<p>The controller consists if a class or prototype that:</p>

<ol>
	<li>is instantiated when&nbsp;<em>mvc</em>&nbsp;is called and the server side data loaded.</li>
	<li>is loaded with a reference to the integrant base path (type), the host and mvc.</li>
	<li>any panels or inner mvc elements are created and processed</li>
	<li><em>init(done)</em> is called for any asynchronous initialisation callback <em>done(error)</em></li>
</ol>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      # do further initialisation requiring async access
      err = null
      ready(err)

  module.exports = Body
catch</pre>

<p>You won't need the try/catch - this just so the server will ignore it here.&nbsp;Integrants by default live in <em>/client/integrants</em>&nbsp;in the current or roaster project. If the name starts with a / then the path is absolute to the project and is not forced into a specific&nbsp;directory. This is useful here since the files are generated in the <em><strong>usdlc2</strong></em> document. Note that the host is a raw DOM element.</p>

<p>Integrants can be modified with options. The parent class responds to those below:</p>

<ul>
	<li><strong>mvc</strong> - name/url of integrant coffee, css and html</li>
	<li><strong>template</strong> - template to use from parent mvc to wrap content (default 0)</li>
	<li><strong>host_class</strong> - defaults to first element in template or template itself if empty</li>
	<li><strong>prepare</strong> - called for each panel in the cargo as they are processed</li>
	<li><strong>require</strong> - csv string of connected modules in a dir matching integrant name. Each adds a member reference into the integrant being an instance of the class exported by the module.</li>
</ul>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "VC", -&gt; @page.test -&gt;
  go = -&gt;
    # The following runs in the page under test
    name = "/gen/usdlc2/Roaster_Client_Support/"+
           "VC_-_Separation_of_Concerns/Core_VC/HTML_View"

    vc = require 'vc'
    # Outer VC - using the html and css from above
    vc document.body, vc: name, (err, body) -&gt;
      process.nextTick -&gt; # allow window repaint
      windows = body.child 'windows'
      top = windows?.offsetTop ? 0
      gwt.test top &gt; 100, "Box is at "+top
  setTimeout go, 4#000</pre>

<p>In this example we create an integrant that fills the page. Inside it has a set of three vertically aligned resizeable panels. The panel_stack code can be viewed in the links below. In practice the three panels will themselves have other integrants:</p>

<ul>
	<li><strong>main.doc</strong>: A CKEditor integrant</li>
	<li><strong>main.code</strong>: A tab integrant containing CodeMirror integrants</li>
	<li><strong>main.windows</strong>: A tab integrant linking to other windows</li>
</ul>

<div class="metadata Ref">Ref: <span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.coffee',path:'../roaster/client/integrants/panel_stack.coffee',category:'integrants'})">panel_stack.coffee</a> </span><span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a></span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/vc/panel_switcher.coffee',category:'vc'})">panel_switcher.coffee</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span><span class="Sequential"><a href="javascript:usdlc.edit_source({value:'Sequential.js',path:'../roaster/common/Sequential.js',category:'common'})">Sequential.js</a> </span><span class="dirs"><a href="javascript:usdlc.edit_source({value:'dirs.js',path:'../roaster/server/dirs.js',category:'server'})">dirs.js</a> </span><span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.less',path:'../roaster/client/vc/modal_panel.less',category:'vc'})">modal_panel.less</a> </span><span class="resize2"><a href="javascript:usdlc.edit_source({value:'resize2.coffee',path:'../roaster/client/resize2.coffee',category:'client'})">resize2.coffee</a> </span><span class="storage"><a href="javascript:usdlc.edit_source({value:'storage.coffee',path:'../roaster/client/storage.coffee',category:'client'})">storage.coffee</a> </span><span class="Storage"><a href="javascript:usdlc.edit_source({value:'Storage.coffee',path:'../roaster/client/Storage.coffee',category:'client'})">Storage.coffee</a> </span><span class="index"><a href="javascript:usdlc.edit_source({value:'index.html',path:'../roaster/test/index.html',category:'test'})">index.html</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>Code View&nbsp;</h4>

<p>It is possible to do without the application integrant by defining a component completely in code. In many cases a combination of the two approaches is best. Every integrant has an <em>add</em> method that uses the template element to append a new inner element. It returns the element added or an inner one of class <em>container</em>. This element can then be used directly or as the host of another nested integrant.</p>

<p><em>&nbsp; &nbsp; integrant.add (name, attributes)</em></p>

<p>where name is added as a class and the name attribute. It also becomes a property of the same name in the parent integrant. Special attributes are:</p>

<ul>
	<li><strong>name</strong>: use instead of the name parameter</li>
	<li><strong>template</strong>: parent integrant template to use - defaults to first defined</li>
	<li><strong>vc</strong>: create a new integrant instance using the new element as host</li>
</ul>

<p><em>ready</em>&nbsp;is optional and is called immediately for static children and after the integrant is initialised if there is a vc attribute. In the latter case the newly created integrant is passed.</p>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Panel Switcher", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    # Outer VC - using the html and css from above
    vc document.body, vc: 'panel_stack', (err, stack) -&gt;
      # let's add the same three panels
      doc = stack.add 'doc',
        style: 'height:50%; background-color: red;'
      doc.contents.innerHTML = 'Document'

      code = stack.add 'code',
      style: 'height:50%; background-color: green;'
      code.contents.innerHTML = 'Code'

      windows = stack.add 'windows',
      style: 'height:50%; background-color: blue;'
      # and change the tests to match the new structure
      windows.contents.innerHTML = 'Window Tabs'

      colour = (expected_colour) -&gt;
        selected = stack.selected.style['background-color']
        return selected is expected_colour

      return gwt.fail('Name') if doc isnt stack.child 'doc'

      stack.select("doc")
      process.nextTick -&gt;
        return gwt.fail('doc') if not colour "red"

        stack.select("code")
        process.nextTick -&gt;
          return gwt.fail('code') if not colour "green"
          gwt.pass()        
  setTimeout go, 4#000
</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/html_editor/open.coffee',category:'html_editor'})">open.coffee</a> </span><span class="require"><a href="javascript:usdlc.edit_source({value:'require.coffee',path:'../roaster/drivers/require.coffee',category:'drivers'})">require.coffee</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.coffee',path:'../roaster/client/vc/panel_stack.coffee',category:'vc'})">panel_stack.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>Integrant Support</h4>

<p>The <em>mvc</em>&nbsp;function calls back when all is ready. The host will have an integrant member pointing to the mvc functionality. The instance is also seeded with references to:</p>

<ul>
	<li><strong>type</strong>: The name of the mvc type/path from the building picture</li>
	<li><strong>host</strong>: circular reference to the DOM host containing this mvc element</li>
	<li><strong>mvc</strong>: reference to the builder for adding further inner mvcs</li>
	<li><strong>select</strong>: select one child and deselect the others</li>
</ul>

<div class="metadata Ref">Ref: <span class="mvc"><a href="javascript:usdlc.edit_source({value:'mvc.coffee',path:'../roaster/client/mvc.coffee',category:'client'})">mvc.coffee</a></span><span class="date"><a href="javascript:usdlc.edit_source({value:'date.coffee',path:'../roaster/common/date.coffee',category:'common'})">date.coffee</a> </span><span class="load"><a href="javascript:usdlc.edit_source({value:'load.js',path:'../roaster/boot/load.js',category:'boot'})">load.js</a> </span><span class="coffee-script"><a href="javascript:usdlc.edit_source({value:'coffee-script.coffee',path:'../roaster/client/packages/coffee-script.coffee',category:'packages'})">coffee-script.coffee</a> </span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.coffee',path:'../roaster/client/bootstrap.coffee',category:'client'})">bootstrap.coffee</a> </span><span class="init"><a href="javascript:usdlc.edit_source({value:'init.coffee',path:'../roaster/client/bootstrap/init.coffee',category:'bootstrap'})">init.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/bootstrap/loaders.coffee',category:'bootstrap'})">loaders.coffee</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/integrants/panel_switcher.coffee',category:'integrants'})">panel_switcher.coffee</a> </span></div>

<h5>init (ready)</h5>

<p>Any integrant class can have an init class that is called last thing before the integrant is deemed ready. All references to inner integrants and panels from the picture have been created.</p>

<h5>select (item)</h5>

<p>Called for integrants with items that can be active - such as tabs. The items themselves, if integrants, are also informed with events '<em>selected</em>' and '<em>deselected</em>'.</p>

<div class="metadata Ref">Ref: <span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.coffee',path:'../roaster/client/integrants/panel_stack.coffee',category:'integrants'})">panel_stack.coffee</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/integrants/panel_switcher.coffee',category:'integrants'})">panel_switcher.coffee</a> </span><span class="dom"><a href="javascript:usdlc.edit_source({value:'dom.coffee',path:'../roaster/client/dom.coffee',category:'client'})">dom.coffee</a> </span></div>

<h5>require (modules, ready)</h5>

<p>Usually called in <em>init(@integrant, [ready])</em>&nbsp;to load additional integrant related modules from <em>client/integrants/<strong>&lt;&lt;module_name&gt;&gt;</strong>/</em>.&nbsp;</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><code>class Body<br />
&nbsp; init: (ready) -&gt;<br />
&nbsp; &nbsp; @require "moda,modb","modc"<br />
&nbsp; &nbsp; assert @mida.test == 2<br />
&nbsp; &nbsp; ready()<br />
module.exports = Body<br />
<br />
####<br />
<br />
class Moda<br />
&nbsp;&nbsp;init: (@integrant, ready) -&gt; ready()<br />
&nbsp;&nbsp;test: 2<br />
module.exports = Moda()</code></div>

<p>&nbsp;Modules have the same make-up as integrants - a class is instantiated and an optional <em>init(@integrant, ready)</em> is run. See the&nbsp;<em>tabs.coffee</em>&nbsp;link below for an example.</p>

<div class="metadata Ref">Ref: <span class="tabs"><a href="javascript:usdlc.edit_source({value:'tabs.coffee',path:'../roaster/client/integrants/html_editor/tabs.coffee',category:'html_editor'})">tabs.coffee</a> </span><span class="file"><a href="javascript:usdlc.edit_source({value:'file.coffee',path:'../roaster/client/vc/html_editor/file.coffee',category:'html_editor'})">file.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/html_editor/open.coffee',category:'html_editor'})">open.coffee</a> </span><span class="toolbar"><a href="javascript:usdlc.edit_source({value:'toolbar.coffee',path:'../roaster/client/vc/html_editor/toolbar.coffee',category:'html_editor'})">toolbar.coffee</a> </span></div>

<h5>walk (path)</h5>

<p>Walk between mvc DOM elements. Use integrant or convenience method on the DOM element.</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><code>main = body.integrant.walk 'main'<br />
windows = main.walk 'windows'<br />
doc = windows.integrant.walk '../doc'<br />
code = doc.walk '/main/doc'</code></div>

<h5>walk(subelement).select</h5>

<p>Select assumes that only one of the list of appended elements can be selected at any one time. It calls <em>opts..action(element, is_selected)</em>&nbsp;on the element being deselected and again on the one being selected. The subelement can be either a name string or a reference to the element to be selected. It also calls <em>selection(item, state)</em> in the class instance to activate visual changes. See <em>panel_switcher</em> for an example.</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><code>tab.onclick = =&gt;&nbsp;tab.integrant.select(tab)</code></div>

<div class="metadata Ref"><br />
<span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/integrants/panel_switcher.coffee',category:'integrants'})">panel_switcher.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/integrants/tab_view.coffee',category:'integrants'})">tab_view.coffee</a></span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.html',path:'../roaster/client/integrants/html_editor.html',category:'integrants'})">html_editor.html</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/Integrant.coffee',category:'client'})">Integrant.coffee</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.css',path:'../roaster/client/integrants/panel_stack.css',category:'integrants'})">panel_stack.css</a> </span></div>

<h3>&nbsp;Panel Stacks</h3>

<p>A panel stack is a group of empty elements stacked one on top of the other, all the width of the host element. The height of any element can be changed and the stack will adjust the height of the others to fill the host. How each panel behaves is controlled by it's style height option:</p>

<ul>
	<li><strong>no height option</strong> - This panel will be high enough to fit content. If content height changes, the panel height changes and donor panels will also change to compensate. Fit panels are optional.</li>
	<li><strong>style: height: '100%'</strong> - for donor panels. They will change height to fill the page should a fit or receiver panel change size. Their must be at least one donor panel and the sum of all the donor panels should be 100%.</li>
	<li><strong>style: height: '200px'</strong> - Receiver panels are those of fixed height. They will take space from or give space back to donor panels as they change size. Receiver panels are optional.</li>
</ul>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<div class="metadata Ref">Ref: <span class="code_editor"><a href="javascript:usdlc.edit_source({value:'code_editor.less',path:'../roaster/client/vc/code_editor.less',category:'vc'})">code_editor.less</a> </span><span class="style"><a href="javascript:usdlc.edit_source({value:'style.less',path:'../roaster/client/icons/style.less',category:'icons'})">style.less</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span></div>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Panel Switcher", -&gt; @page.test -&gt;
  #require.caching = false
  go = -&gt;
    vc = require 'vc'
    # Outer VC - using the html and css from above
    vc document.body, vc: 'panel_stack', (err, stack) -&gt;
      # let's add the same three panels
      doc = stack.add 'doc',
        style: 'height:50%; background-color: red;'
      doc.contents.innerHTML = 'Document'

      code = stack.add 'code',
      style: 'height:50%; background-color: green;'
      code.contents.innerHTML = 'Code'

      windows = stack.add 'windows',
      style: 'height:50%; background-color: blue;'
      # and change the tests to match the new structure
      windows.contents.innerHTML = 'Window Tabs'

      colour = (expected_colour) -&gt;
        selected = stack.selected.style['background-color']
        return selected is expected_colour

      return gwt.fail('Name') if doc isnt stack.child 'doc'

      stack.select("doc")
      process.nextTick -&gt;
        return gwt.fail('doc') if not colour "red"

        stack.select("code")
        process.nextTick -&gt;
          return gwt.fail('code') if not colour "green"
          gwt.pass()
  setTimeout go, 4000
</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span><span class="usdlc2"> </span><br />
<span class="Client_Support"><a href="javascript:usdlc.edit_source({value:'Client_Support.html',path:'../roaster/usdlc2/Client_Support.html',category:'usdlc2'})">Client_Support.html</a> </span><span class="Communications"><a href="javascript:usdlc.edit_source({value:'Communications.html',path:'../roaster/usdlc2/Communications.html',category:'usdlc2'})">Communications.html</a> </span><span class="index"><a href="javascript:usdlc.edit_source({value:'index.html',path:'../roaster/usdlc2/index.html',category:'usdlc2'})">index.html</a> </span><span class="Installation"><a href="javascript:usdlc.edit_source({value:'Installation.html',path:'../roaster/usdlc2/Installation.html',category:'usdlc2'})">Installation.html</a> </span><span class="Preface"><a href="javascript:usdlc.edit_source({value:'Preface.html',path:'../roaster/usdlc2/Preface.html',category:'usdlc2'})">Preface.html</a> </span><span class="Run"><a href="javascript:usdlc.edit_source({value:'Run.html',path:'../roaster/usdlc2/Run.html',category:'usdlc2'})">Run.html</a> </span><span class="The_Event_Model"><a href="javascript:usdlc.edit_source({value:'The_Event_Model.html',path:'../roaster/usdlc2/The_Event_Model.html',category:'usdlc2'})">The_Event_Model.html</a> </span><span class="respond"><a href="javascript:usdlc.edit_source({value:'respond.coffee',path:'../roaster/server/http/respond.coffee',category:'http'})">respond.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="coffee" type="coffee">
gwt.open_page "index.html"

gwt.add "VC", -&gt; @page.test -&gt;
  go = -&gt;
    # The following runs in the page under test
    # View the source in the section above
    name = "/gen/usdlc2/Roaster_Client_Support/"+
           "VC_-_Separation_of_Concerns/Core_VC/HTML_View"

    vc = require 'vc'
    # Outer VC - using the html and css from above
    vc document.body, vc: name, (err, body) -&gt;
      process.nextTick -&gt; # allow window repaint
      windows = body.child 'windows'
      top = windows.offsetTop
      gwt.test top &gt; 100, "Box is at "+top
  setTimeout go, 4000</pre>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<p class="metadata Ref"> </p>

<div class="metadata Ref"><span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/Integrant.coffee',category:'client'})">Integrant.coffee</a>&nbsp;</span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/vc/panel_switcher.coffee',category:'vc'})">panel_switcher.coffee</a> </span><span class="Resize2"><a href="javascript:usdlc.edit_source({value:'Resize2.coffee',path:'../roaster/client/Resize2.coffee',category:'client'})">Resize2.coffee</a> </span><span class="resize2"><a href="javascript:usdlc.edit_source({value:'resize2.coffee',path:'../roaster/client/resize2.coffee',category:'client'})">resize2.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="code_editor"><a href="javascript:usdlc.edit_source({value:'code_editor.coffee',path:'../roaster/client/vc/code_editor.coffee',category:'vc'})">code_editor.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/code_editor/open.coffee',category:'code_editor'})">open.coffee</a> </span><span class="app"><a href="javascript:usdlc.edit_source({value:'app.coffee',path:'../roaster/client/app.coffee',category:'client'})">app.coffee</a> </span><span class="common"><a href="javascript:usdlc.edit_source({value:'common.less',path:'../roaster/client/common.less',category:'client'})">common.less</a> </span><span class="style"><a href="javascript:usdlc.edit_source({value:'style.less',path:'../roaster/client/style.less',category:'client'})">style.less</a> </span><span class="codemirror"><a href="javascript:usdlc.edit_source({value:'codemirror.coffee',path:'../roaster/client/pkgs/codemirror.coffee',category:'pkgs'})">codemirror.coffee</a> </span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.html',path:'../roaster/client/bootstrap.html',category:'client'})">bootstrap.html</a> </span></div>

<h3>Panel Abreast</h3>

<p>&nbsp;For side-by-side panels, use <strong>panel_abreast</strong>. By default each panel will use the minimum width necessary to hold content.</p>

<ul>
	<li><strong>style="width:30%"</strong> -- Control the width of panels in pixels, percentage or ems.</li>
	<li><strong>style="min-width: 200px"</strong> -- Ensure that a panel does not become too narrow.</li>
	<li><strong>style="max-width: 700px"</strong> -- Stop a panel hogging the width. If the content word wraps, this will happen at that width.</li>
	<li><strong>class="hide-on-overflow"</strong> -- If all the panels with fixed or minimum widths add up to wider than the window you will normally get a horizontal scroll bar. Panels with this attribute will be hidden instead - in a right to left order. The panel will emit "hide" and "show" events so that the program can react.</li>
</ul>

<div class="metadata Ref">Ref: <span class="resize2"><a href="javascript:usdlc.edit_source({value:'resize2.coffee',path:'../roaster/client/resize2.coffee',category:'client'})">resize2.coffee</a> </span><span class="dom"><a href="javascript:usdlc.edit_source({value:'dom.coffee',path:'../roaster/client/dom.coffee',category:'client'})">dom.coffee</a> </span></div>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Panel Abreast", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'panel_abreast', (err, pab) -&gt;
      one = pab.add 'one',
        style: 'background-color: red;'
      one.innerHTML = 'One'

      two = pab.add 'two',
        style: 'background-color: green;'
      two.innerHTML = 'Two'

      #### Everything below is verification
      gwt.pass()
  setTimeout go, 4#000</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><br />
<span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.html',path:'../roaster/client/bootstrap.html',category:'client'})">bootstrap.html</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;table class="vc panels" vc="panel_abreast"&gt;
  &lt;td class="active one"
       style="background-color:red;min-width:400px;"&gt;
       One
  &lt;/td&gt;
  &lt;td class="two hide-on-overflow"
       style="background-color:green;min-width:400px;"&gt;
       Two
  &lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  module.exports = class Body extends Integrant
    init: (ready) -&gt;
      @panels = @get_vc_for 'panels'
      # do further initialisation requiring async access
      ready(err = false)
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Panel Switcher", -&gt; @page.test -&gt;
  go = -&gt;
    require.caching = false
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Panel_Abreast/"+
         "HTML_View"
    # Outer VC - using the html and css from above
    vc = require('vc')
    vc document.body, vc: name, (err, body) -&gt;
      gwt.pass()
  setTimeout go, 4000</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><br />
<span class="panel_abreast"><a href="javascript:usdlc.edit_source({value:'panel_abreast.coffee',path:'../roaster/client/vc/panel_abreast.coffee',category:'vc'})">panel_abreast.coffee</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.coffee',path:'../roaster/client/vc/panel_stack.coffee',category:'vc'})">panel_stack.coffee</a> </span><br />
<span class="index"><a href="javascript:usdlc.edit_source({value:'index.js',path:'../roaster/server/morph/index.js',category:'morph'})">index.js</a> </span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.html',path:'../roaster/client/bootstrap.html',category:'client'})">bootstrap.html</a> </span></div>

<h3>Panel Switcher</h3>

<p>Given a host, add a series of panels where only one will be visible at any one time. Call insert() and append() for new panels and select() to choose which one is displayed.</p>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Panel Switcher", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'panel_switcher', (err, sw) -&gt;
      one = sw.add 'one',
        style: 'background-color: red;'
      one.innerHTML = 'One'

      two = sw.add 'two',
        style: 'background-color: green;'
      two.innerHTML = 'Two'

      sw.select("one")
    
      #### Everything below is verification
      
      colour = (expected_colour) -&gt;
        selected = sw.selected.style['background-color']
        return selected is expected_colour

      return gwt.fail('Name') if one isnt sw.child('one')

      process.nextTick -&gt;
        return gwt.fail('one') if not colour "red"

        sw.select("two")
        process.nextTick -&gt;
          return gwt.fail('two') if not colour "green"
          gwt.pass()        
  setTimeout go, 4#000</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.html',path:'../roaster/client/vc/tabbed_panels.html',category:'vc'})">tabbed_panels.html</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.less',path:'../roaster/client/vc/panel_switcher.less',category:'vc'})">panel_switcher.less</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.less',path:'../roaster/client/vc/drawers.less',category:'vc'})">drawers.less</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.html',path:'../roaster/client/vc/tab_view.html',category:'vc'})">tab_view.html</a> </span><span class="common"><a href="javascript:usdlc.edit_source({value:'common.less',path:'../roaster/client/common.less',category:'client'})">common.less</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc panels" vc="panel_switcher"&gt;
  &lt;div class="active one"
       style="background-color:red"&gt;One&lt;/div&gt;
  &lt;div class="two"
       style="background-color:green"&gt;Two&lt;/div&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @panels = @get_vc_for 'panels'
      # do further initialisation requiring async access

      @panels.on 'selected', (panel) =&gt;
        @selected_colour = panel.style["background-color"]
        # panel is displayed - update if necessary
      @panels.reset_selection()
      
      @panels.on 'deselected', (panel) =&gt;
        # turn of unnecessary panel updating
      ready(err = false)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Panel Switcher", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Panel_Switcher/"+
         "HTML_View"
    # Outer VC - using the html and css from above
    vc = require('vc')
    vc document.body, vc: name, (err, body) -&gt;
      colour = (expected_colour) -&gt;
        return body.selected_colour is expected_colour

      body.panels.select("one")
      process.nextTick -&gt;
        return gwt.fail('One') if not colour "red"

        body.select("two")
        process.nextTick -&gt;
          return gwt.fail('Two') if not colour "green"
          gwt.pass()      
  setTimeout go, 4#000</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a></span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/vc/panel_switcher.coffee',category:'vc'})">panel_switcher.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.coffee',path:'../roaster/client/vc/tabbed_panels.coffee',category:'vc'})">tabbed_panels.coffee</a> </span><span class="common"><a href="javascript:usdlc.edit_source({value:'common.less',path:'../roaster/client/common.less',category:'client'})">common.less</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h3>Messages</h3>

<p>Messages consist of a title, a body and a priority. They are displayed by title and sorted by priority and time. &nbsp;They close when they are clicked, overflow their container or their age exceeds a defined point. Hovering shows their age and the longer text in the body.&nbsp;Priority defines colour and aging rules. The default is as follows:</p>

<ol>
	<li>Fatal: Red. Aged: never. Don't close on overflow</li>
	<li>Error: Dark red. Aged: never</li>
	<li>Alert: Orange. Aged: 48 hours</li>
	<li>Pass: Green. Aged: 1 hour</li>
	<li>Message: Grey. Aged: 5 minutes</li>
</ol>

<p>The <em>add</em> method takes a single string in the following format:</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><tt>type: title - body</tt></div>

<p>where</p>

<ul>
	<li><strong>type</strong> is the error type from above (or more added). Case insensitive.</li>
	<li><strong>title</strong> is displayed in the message space.</li>
	<li><strong>body</strong> and age are displayed when a message is hovered over.</li>
</ul>

<div class="metadata Ref">Ref: <span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.html',path:'../roaster/client/vc/tabbed_panels.html',category:'vc'})">tabbed_panels.html</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.html',path:'../roaster/client/vc/messages.html',category:'vc'})">messages.html</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.less',path:'../roaster/client/vc/tab_view.less',category:'vc'})">tab_view.less</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.html',path:'../roaster/client/vc/panel_switcher.html',category:'vc'})">panel_switcher.html</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.less',path:'../roaster/client/vc/html_editor.less',category:'vc'})">html_editor.less</a> </span></div>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Messages", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'messages', (err, messages) -&gt;
      adder = (elapse, message) -&gt;
        setTimeout (-&gt; messages.add message), adder
        
      adder 11, "Message: Test 1 - The first test"
      adder 22, "Error: Error - Error message"
      adder 33, "Message: Test 2 - One more message"
      adder 44, "Fatal: Fatality"
      adder 55, "Test 3 - checking sorting"
      adder 66, "Test 1"
    
      #### Everything below is verification
      
      check = (against) -&gt;
        text = messages.host.innerHTML.replace /&lt;.*?&gt;+/g, ' '
        text = text.replace(/\s+/g, ' ').trim()
        return true if text is against
        gwt.fail "Expecting '#{against}', found '#{text}'"
        return false
        
      process.nextTick -&gt;
        if check "Test 1 Test 3 Fatality Test 2 Error"
          gwt.pass()

  setTimeout go, 4#000 </pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.less',path:'../roaster/client/vc/messages.less',category:'vc'})">messages.less</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.less',path:'../roaster/client/vc/tab_view.less',category:'vc'})">tab_view.less</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.less',path:'../roaster/client/vc/panel_stack.less',category:'vc'})">panel_stack.less</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.html',path:'../roaster/client/vc/panel_switcher.html',category:'vc'})">panel_switcher.html</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;span class="vc" vc="messages"&gt;&lt;/span&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @messages = @get_vc_for 'messages'
      # do further initialisation requiring async access

      ready(err = null)
      
    message: (text) -&gt; @messages.add text

  module.exports = Body
catch  </pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Messages/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      body.message "Hello world"
      body.message "Alert: Read Me - False alarm"

      check = (against) -&gt;
        text = body.messages.host.innerHTML.replace /&lt;.*?&gt;+/g, ' '
        text = text.replace(/\s+/g, ' ').trim()
        return true if text is against
        gwt.fail "Expecting '#{against}', found '#{text}'"
        return false
        
      process.nextTick -&gt;
        if check "Read Me Hello world"
          gwt.pass()
          
  setTimeout go, 4#000 </pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.less',path:'../roaster/client/vc/messages.less',category:'vc'})">messages.less</a> </span></div>

<h3>Tab View</h3>

<p>Display tabs. When selected, it's action property is called. You can select() a tab programmatically.</p>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'tab_view', (err, tabs) -&gt;
      one   = tabs.add 'One'
      two   = tabs.add 'Two'
      three = tabs.add 'Three'
      four  = tabs.add 'Four'

      tabs.select "Four"
      
      #### Everything below is verification

      check = (expected) -&gt;
        actual = tabs.selected?.innerHTML
        return true if actual is expected
        gwt.fail "Expected " + expected + ", found " + actual
        return false
      
      process.nextTick -&gt;
        return if not check('Four')
        tabs.select('Two')
        return if not check('Two')
        tabs.child('Three').click()
        return if not check('Three')
        gwt.pass()
  setTimeout go, 4#000
</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.coffee',path:'../roaster/client/vc/tabbed_panels.coffee',category:'vc'})">tabbed_panels.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc tabs" vc="tab_view"&gt;
  &lt;a&gt;One&lt;/a&gt;
  &lt;a&gt;Two&lt;/a&gt;
  &lt;a&gt;Three&lt;/a&gt;
  &lt;a class="active"&gt;Four&lt;/a&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @tabs = @get_vc_for 'tabs'
      # do further initialisation requiring async access

      @tabs.on 'selected', (tab) =&gt;
        @selected = tab.innerHTML
        # tab is displayed - update if necessary
      
      @tabs.on 'deselected', (panel) =&gt;
        # turn off unnecessary tabs updating
        
      @tabs.reset_selection()
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Tab_View/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      tabs = body.tabs

      check = (expected) -&gt;
        return true if body.selected is expected
        gwt.fail "Expected " + expected +
        ", found " + body.selected
        return false

      process.nextTick -&gt;
        return if not check('Four')
        tabs.select('Two')
        return if not check('Two')
        tabs.child('Three').click()
        return if not check('Three')
        gwt.pass()
  setTimeout go, 4#000</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a></span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.coffee',path:'../roaster/client/vc/tabbed_panels.coffee',category:'vc'})">tabbed_panels.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h3>Tabbed Panels</h3>

<p>A combination of tab_view and panel_switcher is most used.</p>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'tabbed_panels', (err, tp) -&gt;
      one   = tp.add 'One',
        panel: style: 'background-color: red;'
      one.innerHTML = 1
      two   = tp.add 'Two',
        panel: style: 'background-color: green;'
      two.innerHTML = 2
      three = tp.add 'Three',
        panel: style: 'background-color: blue;'
      three.innerHTML = 3
      four  = tp.add 'Four',
        panel: style: 'background-color: yellow;'
      four.innerHTML = 4

      tp.select "Four"
      
      #### Everything below is verification

      check = (tab, colour) -&gt;
        st = tp.selected.tab.innerHTML
        sc = tp.selected.style["background-color"]
        return true if st is tab and sc is colour
        gwt.fail "Expected #{tab}/#{colour}" +
                 ", found #{st}/#{sc}"
        return false

      process.nextTick -&gt;
        return if not check('Four', 'yellow')
        tp.select('Two')
        return if not check('Two', 'green')
        tp.tabs.child('Three').click()
        return if not check('Three', 'blue')
        gwt.pass()
  setTimeout go, 4#000
</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.coffee',path:'../roaster/client/vc/tabbed_panels.coffee',category:'vc'})">tabbed_panels.coffee</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.html',path:'../roaster/client/vc/panel_switcher.html',category:'vc'})">panel_switcher.html</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span><span class="style"><a href="javascript:usdlc.edit_source({value:'style.less',path:'../roaster/client/roast/style.less',category:'roast'})">style.less</a> </span><span class="roast"><a href="javascript:usdlc.edit_source({value:'roast.coffee',path:'../roaster/client/roast.coffee',category:'client'})">roast.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/bootstrap/loaders.coffee',category:'bootstrap'})">loaders.coffee</a> </span><span class="init"><a href="javascript:usdlc.edit_source({value:'init.coffee',path:'../roaster/client/roast/init.coffee',category:'roast'})">init.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="scheduler"><a href="javascript:usdlc.edit_source({value:'scheduler.coffee',path:'../roaster/client/vc/dhtmlx/scheduler.coffee',category:'dhtmlx'})">scheduler.coffee</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.less',path:'../roaster/client/vc/drawers.less',category:'vc'})">drawers.less</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc main" vc="tabbed_panels"&gt;
  &lt;div name="One"
       style="background-color:red"&gt;1&lt;/div&gt;
  &lt;div name="Two"
       style="background-color:green"&gt;2&lt;/div&gt;
  &lt;div name="Three"
       style="background-color:blue"&gt;3&lt;/div&gt;
  &lt;div name="Four" class="active"
       style="background-color:yellow"&gt;4&lt;/div&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @main = @get_vc_for 'main'
      
      do set_selected = =&gt;
        @selected =
          tab:   @main.tabs.selected.innerHTML
          panel: @main.panels.selected.style["background-color"]
      @main.on 'selected', set_selected

      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Tabbed_Panels/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      main = body.main

      check = (tab, colour) -&gt;
        sel = body.selected
        if sel.tab is tab and sel.panel is colour
          return true
        gwt.fail "Expected #{tab}/#{colour}" +
                 ", found #{sel.tab}/#{sel.panel}"
        return false

      process.nextTick -&gt;
        return if not check('Four', 'yellow')
        main.select('Two')
        return if not check('Two', 'green')
        main.tabs.child('Three').click()
        return if not check('Three', 'blue')
        gwt.pass()
  setTimeout go, 4#000</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.coffee',path:'../roaster/client/vc/tabbed_panels.coffee',category:'vc'})">tabbed_panels.coffee</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.css',path:'../roaster/client/vc/panel_switcher.css',category:'vc'})">panel_switcher.css</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Sequential"><a href="javascript:usdlc.edit_source({value:'Sequential.js',path:'../roaster/common/Sequential.js',category:'common'})">Sequential.js</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h3>Drawers</h3>

<p>A drawer is a panel that can pull out from any of the 4 edges of the window. The usually close again once an activity is complete or focus changes to another panel</p>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Drawers", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    add_drawer = (side, added) -&gt;
      vc document.body, vc: 'drawers', side: side,
      (err, drawers) -&gt;
        fill = (dr, contents) -&gt;
          dr.innerHTML = "&lt;&lt;&lt;&lt;&lt; #{contents} &gt;&gt;&gt;&gt;&gt;"
          dr.innerHTML += dr.innerHTML for i in [1..5]
        d1 = drawers.add "#{side} 1",
          panel: style: 'background-color: red;'
        fill(d1, 1)
        d2 = drawers.add "#{side} 2",
          panel: style: 'background-color: green;'
        fill(d2, 2)
        added {drawers, d1, d2, side}
    
    add_drawer 'left', (left) -&gt;
      add_drawer 'right', (right) -&gt;

          #### Everything below is verification

        check = (x, colour) -&gt;
          panel = document.elementFromPoint(x, 20)
          bc = panel.style["background-color"]
          return true if not bc and not colour
          return true if bc is colour
          gwt.fail "Expected #{colour}, found #{bc}"
          return false

        check_drawers = (one, pos) -&gt;
          process.nextTick -&gt;
            return if not check(pos)
            one.drawers.select(one.d1.tab)
            process.nextTick -&gt;
              return if not check(pos, 'red')
              one.drawers.select("#{one.side}_2")
              process.nextTick -&gt;
                return if not check(pos, 'green')
                gwt.pass()

        check_drawers left, 20
        check_drawers right, window.innerWidth - 50
  setTimeout go, 4#000
</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.html',path:'../roaster/client/vc/drawers.html',category:'vc'})">drawers.html</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.html',path:'../roaster/client/vc/tab_view.html',category:'vc'})">tab_view.html</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.html',path:'../roaster/client/vc/panel_switcher.html',category:'vc'})">panel_switcher.html</a> </span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.html',path:'../roaster/client/vc/tabbed_panels.html',category:'vc'})">tabbed_panels.html</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="common"><a href="javascript:usdlc.edit_source({value:'common.less',path:'../roaster/client/common.less',category:'client'})">common.less</a> </span><span class="style"><a href="javascript:usdlc.edit_source({value:'style.less',path:'../roaster/client/roast/style.less',category:'roast'})">style.less</a> </span><span class="environment"><a href="javascript:usdlc.edit_source({value:'environment.coffee',path:'../roaster/client/roaster/environment.coffee',category:'roaster'})">environment.coffee</a> </span><span class="init"><a href="javascript:usdlc.edit_source({value:'init.coffee',path:'../roaster/client/roast/init.coffee',category:'roast'})">init.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc left" vc="drawers" side="left"&gt;
  &lt;div name="One"
       style="background-color:red"&gt;1111111111&lt;/div&gt;
  &lt;div name="Two"
       style="background-color:green"&gt;222222222&lt;/div&gt;
  &lt;div name="Three"
       style="background-color:blue"&gt;3333333333&lt;/div&gt;
  &lt;div class="active" name="Four"
       style="background-color:yellow"&gt;4444444444&lt;/div&gt;
&lt;/div&gt;

&lt;div class="vc right" vc="drawers" side="right"&gt;
  &lt;div class="active" name="One"
       style="background-color:red"&gt;1111111111&lt;/div&gt;
  &lt;div name="Two"
       style="background-color:green"&gt;222222222&lt;/div&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      loc = @left = @get_vc_for 'left'
      @right = @get_vc_for 'right'
      
      do set_selected = (loc) =&gt;
        @selected =
          tab:   loc.tabs.selected.innerHTML
          panel: loc.panels.selected.style["background-color"]
      @left.on 'selected', =&gt; set_selected @left
      @right.on 'selected', =&gt; set_selected @right

      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Drawers/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;

      check = (tab, colour) -&gt;
        sel = body.selected
        if sel.tab is tab and sel.panel is colour
          return true
        gwt.fail "Expected #{tab}/#{colour}" +
                 ", found #{sel.tab}/#{sel.panel}"
        return false

      process.nextTick -&gt;
        return if not check('Four', 'yellow')
        body.left.select('Two')
        return if not check('Two', 'green')
        body.left.tabs.child('Three').click()
        return if not check('Three', 'blue')
        body.right.select('Two')
        return if not check('Two', 'green')
        gwt.pass()
  setTimeout go, 4000
 </pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.coffee',path:'../roaster/client/vc/drawers.coffee',category:'vc'})">drawers.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="tabbed_panels"><a href="javascript:usdlc.edit_source({value:'tabbed_panels.coffee',path:'../roaster/client/vc/tabbed_panels.coffee',category:'vc'})">tabbed_panels.coffee</a> </span><span class="dialog"><a href="javascript:usdlc.edit_source({value:'dialog.coffee',path:'../roaster/client/dialog.coffee',category:'client'})">dialog.coffee</a> </span><span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.coffee',path:'../roaster/client/vc/modal_panel.coffee',category:'vc'})">modal_panel.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a></span></div>

<h3>Modal Panel</h3>

<p>Because modal panels are used everywhere, there is a shortcut:</p>

<div style="background: rgb(238, 238, 238); padding: 5px 10px; border: 1px solid rgb(204, 204, 204); border-image: none;"><code>roaster.modal (panel) -&gt;<br />
&nbsp;&nbsp;panel.innerHTML = "Hello world"</code></div>

<div class="metadata Ref">Ref: <span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.coffee',path:'../roaster/client/vc/modal_panel.coffee',category:'vc'})">modal_panel.coffee</a> </span><span class="compile"><a href="javascript:usdlc.edit_source({value:'compile.coffee',path:'../roaster/client/vc/code_editor/compile.coffee',category:'code_editor'})">compile.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/code_editor/open.coffee',category:'code_editor'})">open.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span><span class="roast"><a href="javascript:usdlc.edit_source({value:'roast.coffee',path:'../roaster/client/roast.coffee',category:'client'})">roast.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="mode"><a href="javascript:usdlc.edit_source({value:'mode.coffee',path:'../roaster/client/vc/code_editor/mode.coffee',category:'code_editor'})">mode.coffee</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.coffee',path:'../roaster/client/vc/messages.coffee',category:'vc'})">messages.coffee</a> </span></div>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Modal Panels", -&gt; @page.test -&gt;
  go = -&gt;
    bg = ("123456789" for i in [1..500]).join(' ')
    document.body.innerHTML = bg
    
    vc = require 'vc'
    vc document.body, vc: 'modal_panel', (err, modal) -&gt;
      panel = modal.container
      panel.innerHTML = "&lt;&lt;&lt;&lt;&lt; PANEL CONTENTS &gt;&gt;&gt;&gt;&gt;"
      panel.innerHTML += panel.innerHTML for i in [1..4]
      modal.show()
    
      #### Everything below is verification

      process.nextTick -&gt;
        bg = document.elementFromPoint 0, 0
        if not bg.classList.contains 'background'
          return gwt.fail "modal not showing"
        
        modal.hide()
        process.nextTick -&gt;
          bg = document.elementFromPoint 0, 0
          if bg.classList.contains 'background'
            return gwt.fail "modal not hidden"

          modal.show()
          gwt.pass()
        
  setTimeout go, 4000
 </pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.coffee',path:'../roaster/client/vc/drawers.coffee',category:'vc'})">drawers.coffee</a> </span><span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.less',path:'../roaster/client/vc/modal_panel.less',category:'vc'})">modal_panel.less</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc" vc="modal_panel"&gt;
  The rain in spain falls mainly on the plain.&lt;br&gt;
  Now is the time for all good men to come to the
  aid of the party.
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @panel = @get_vc_for 'modal_panel'
      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tab View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Modal_Panel/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, modal) -&gt;
      modal.panel.show()
      process.nextTick -&gt;
        bg = document.elementFromPoint 0, 0
        if not bg.classList.contains 'background'
          return gwt.fail "modal not showing"
        
        modal.panel.hide()
        process.nextTick -&gt;
          bg = document.elementFromPoint 0, 0
          if bg.classList.contains 'background'
            return gwt.fail "modal not hidden"

          modal.panel.show()
          gwt.pass()
  setTimeout go, 4#000
  </pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.html',path:'../roaster/client/vc/modal_panel.html',category:'vc'})">modal_panel.html</a> </span><span class="tree_view"><a href="javascript:usdlc.edit_source({value:'tree_view.coffee',path:'../roaster/client/vc/tree_view.coffee',category:'vc'})">tree_view.coffee</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span><span class="window_manager"><a href="javascript:usdlc.edit_source({value:'window_manager.coffee',path:'../roaster/client/vc/window_manager.coffee',category:'vc'})">window_manager.coffee</a> </span></div>

<h3>Window Manager</h3>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Window Manager", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'window_manager', (err, wm) -&gt;
      one   = wm.add 'One',
        panel: style: 'background-color: red;'
      one.innerHTML = 1
      four  = wm.add 'Four',
        panel: style: 'background-color: yellow;'
      four.innerHTML = 4

      wm.select "Four"
      
      #### Everything below is verification

      check = (tab, colour) -&gt;
        st = wm.selected.tab.innerHTML
        sc = wm.selected.style["background-color"]
        return true if st is tab and sc is colour
        gwt.fail "Expected #{tab}/#{colour}" +
                 ", found #{st}/#{sc}"
        return false

      process.nextTick -&gt;
        return if not check('Four', 'yellow')
        wm.tabs.child('One').click()
        return if not check('One', 'red')
        gwt.pass()
  setTimeout go, 4#000
 </pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="tabbed_panels">&nbsp;</span><span class="window_manager"><a href="javascript:usdlc.edit_source({value:'window_manager.coffee',path:'../roaster/client/vc/window_manager.coffee',category:'vc'})">window_manager.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="panel_switcher"><a href="javascript:usdlc.edit_source({value:'panel_switcher.coffee',path:'../roaster/client/vc/panel_switcher.coffee',category:'vc'})">panel_switcher.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc main" vc="window_manager"&gt;
  &lt;div name="One"
       style="background-color:red"&gt;1&lt;/div&gt;
  &lt;div name="Two"
       style="background-color:green"&gt;2&lt;/div&gt;
  &lt;div name="Three"
       style="background-color:blue"&gt;3&lt;/div&gt;
  &lt;div class='active' name="Four"
       style="background-color:yellow"&gt;4&lt;/div&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @main = @get_vc_for 'main'
      
      do set_selected = =&gt;
        @selected =
          tab:   @main.tabs.selected.innerHTML
          panel: @main.tabs.selected.panel.style["background-color"]
      @main.on 'selected', set_selected

      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Window Manager", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Window_Manager/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      main = body.main

      check = (tab, colour) -&gt;
        sel = body.selected
        if sel.tab is tab and sel.panel is colour
          return true
        gwt.fail "Expected #{tab}/#{colour}" +
                 ", found #{sel.tab}/#{sel.panel}"
        return false

      process.nextTick -&gt;
        return if not check('Four', 'yellow')
        main.select('Two')
        return if not check('Two', 'green')
        main.tabs.child('Three').click()
        return if not check('Three', 'blue')
        gwt.pass()
  setTimeout go, 4#000 </pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="tree_view"><a href="javascript:usdlc.edit_source({value:'tree_view.coffee',path:'../roaster/client/vc/tree_view.coffee',category:'vc'})">tree_view.coffee</a> </span><span class="popup_menu"><a href="javascript:usdlc.edit_source({value:'popup_menu.coffee',path:'../roaster/client/vc/popup_menu.coffee',category:'vc'})">popup_menu.coffee</a> </span></div>

<h3>Popup Menu View</h3>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Pop-up Menu", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'popup_menu', context_menu: true,
    type: "menu", (err, pm) -&gt;
      one   = pm.branch 'One'
      leaf  = pm.leaf 'One a', 'javascript: alert("One a")'
      pm.up()
      for i in [2..100]
        pm.leaf 'Leaf '+i, 'javascript: alert("Click")'
        
      pm.context_menu() # redundant: for example only
      pm.at clientX: 200, clientY: 100
      
      #### Everything below is verification

      process.nextTick -&gt;
        height = one.clientHeight
        one.click()
        process.nextTick -&gt;
          if height &gt;= one.clientHeight
            return gwt.fail('open')
          gwt.pass()
  setTimeout go, 4#000 </pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="popup_menu"><a href="javascript:usdlc.edit_source({value:'popup_menu.coffee',path:'../roaster/client/vc/popup_menu.coffee',category:'vc'})">popup_menu.coffee</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.html',path:'../roaster/client/vc/html_editor.html',category:'vc'})">html_editor.html</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.html',path:'../roaster/client/vc/panel_stack.html',category:'vc'})">panel_stack.html</a> </span><span class="tree_view"><a href="javascript:usdlc.edit_source({value:'tree_view.html',path:'../roaster/client/vc/tree_view.html',category:'vc'})">tree_view.html</a> </span><span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.html',path:'../roaster/client/vc/modal_panel.html',category:'vc'})">modal_panel.html</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.html',path:'../roaster/client/vc/tab_view.html',category:'vc'})">tab_view.html</a> </span><span class="style"><a href="javascript:usdlc.edit_source({value:'style.less',path:'../roaster/client/roast/style.less',category:'roast'})">style.less</a> </span><span class="code_editor"><a href="javascript:usdlc.edit_source({value:'code_editor.less',path:'../roaster/client/vc/code_editor.less',category:'vc'})">code_editor.less</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.less',path:'../roaster/client/vc/drawers.less',category:'vc'})">drawers.less</a> </span><span class="dependency"><a href="javascript:usdlc.edit_source({value:'dependency.coffee',path:'../roaster/client/dependency.coffee',category:'client'})">dependency.coffee</a> </span><span class="context_menu"><a href="javascript:usdlc.edit_source({value:'context_menu.coffee',path:'../roaster/client/vc/code_editor/context_menu.coffee',category:'code_editor'})">context_menu.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/code_editor/open.coffee',category:'code_editor'})">open.coffee</a> </span><span class="compile"><a href="javascript:usdlc.edit_source({value:'compile.coffee',path:'../roaster/client/vc/code_editor/compile.coffee',category:'code_editor'})">compile.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc main" vc="popup_menu"&gt;
  
    &lt;li class="one"&gt;One
       
        
          &lt;a href='javascript:alert("1a")'&gt;One a&lt;/a&gt;
         &lt;/li&gt;
          &lt;a href='javascript:alert("1b")'&gt;One b&lt;/a&gt;
        &lt;/li&gt;
      &lt;/ol&gt;
    &lt;/li&gt;
    &lt;a href='javascript:alert("2")'&gt;Two&lt;/a&gt;&lt;/li&gt;
    &lt;a href='javascript:alert("3")'&gt;Three&lt;/a&gt;&lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @main = @get_vc_for 'main'
      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Pop-up Menu", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Popup_Menu_View/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      main = body.main

      process.nextTick -&gt;
        one = main.child('one')
        chk = one.getElementsByTagName('input')[0]
        height = one.clientHeight
        chk.click()
        process.nextTick -&gt;
          if height &gt;= one.clientHeight
            return gwt.fail('open')
          gwt.pass()
  setTimeout go, 4000 </pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="popup_menu"><a href="javascript:usdlc.edit_source({value:'popup_menu.html',path:'../roaster/client/vc/popup_menu.html',category:'vc'})">popup_menu.html</a> </span><span class="modal_panel"><a href="javascript:usdlc.edit_source({value:'modal_panel.coffee',path:'../roaster/client/vc/modal_panel.coffee',category:'vc'})">modal_panel.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="tree_view"><a href="javascript:usdlc.edit_source({value:'tree_view.coffee',path:'../roaster/client/vc/tree_view.coffee',category:'vc'})">tree_view.coffee</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.html',path:'../roaster/client/vc/drawers.html',category:'vc'})">drawers.html</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.html',path:'../roaster/client/vc/messages.html',category:'vc'})">messages.html</a> </span></div>

<h3>Tree View</h3>

<p>The tree view displays structured data as a tree where branches can be open and closed and leaves selected.</p>

<div class="metadata Ref">Ref: <span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a>&nbsp;</span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span></div>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tree View", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'tree_view', (err, tv) -&gt;
      one   = tv.branch 'One'
      leaf  = tv.leaf 'One a', 'javascript: alert("One a")'
      tv.up()
      tv.leaf 'Two', 'javascript: alert("Two")'
      
      #### Everything below is verification

      process.nextTick -&gt;
        height = one.clientHeight
        one.click()
        process.nextTick -&gt;
          if height &gt;= one.clientHeight
            return gwt.fail('open')
          gwt.pass()
  setTimeout go, 4#000 </pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc main" vc="tree_view"&gt;
  &lt;ol&gt;
    &lt;li class="one"&gt;One
      &lt;ol&gt; 
        &lt;li&gt;&lt;a href=''&gt;One a&lt;/a&gt;&lt;/li&gt;
      &lt;/ol&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;a href=''&gt;Two&lt;/a&gt;&lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @main = @get_vc_for 'main'
      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Tree View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
         "VC_-_Separation_of_Concerns/Tree_View/"+
         "HTML_View"
    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      main = body.main

      process.nextTick -&gt;
        one = main.child('one')
        chk = one.getElementsByTagName('input')[0]
        height = one.clientHeight
        chk.click()
        process.nextTick -&gt;
          if height &gt;= one.clientHeight
            return gwt.fail('open')
          gwt.pass()
  setTimeout go, 4#000</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.coffee',path:'../roaster/client/vc/messages.coffee',category:'vc'})">messages.coffee</a> </span><span class="window_manager"><a href="javascript:usdlc.edit_source({value:'window_manager.coffee',path:'../roaster/client/vc/window_manager.coffee',category:'vc'})">window_manager.coffee</a> </span></div>

<h3>HTML Editor View</h3>

<p>This integrant wraps ckeditor for convenient use.</p>

<div class="metadata Ref">Ref: <span class="file"><a href="javascript:usdlc.edit_source({value:'file.coffee',path:'../roaster/client/model/file.coffee',category:'model'})">file.coffee</a> </span><span class="File"><a href="javascript:usdlc.edit_source({value:'File.coffee',path:'../roaster/client/model/File.coffee',category:'model'})">File.coffee</a> </span><span class="Storage"><a href="javascript:usdlc.edit_source({value:'Storage.coffee',path:'../roaster/client/Storage.coffee',category:'client'})">Storage.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="panel_stack"><a href="javascript:usdlc.edit_source({value:'panel_stack.coffee',path:'../roaster/client/vc/panel_stack.coffee',category:'vc'})">panel_stack.coffee</a> </span><span class="timer"><a href="javascript:usdlc.edit_source({value:'timer.coffee',path:'../roaster/common/timer.coffee',category:'common'})">timer.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span></div>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "HTML Editor", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'html_editor',
    (err, html_editor) -&gt;
      
      #### Everything below is verification

      ed = html_editor.ed
      ed.setData "The rain in spain"
      process.nextTick -&gt;
        contents = ed.getData()
        if contents.indexOf("The rain in spain") is -1
          return gwt.fail('Contents incorrect')
        gwt.pass()
        
  setTimeout go, 4#000

</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/html_editor/open.coffee',category:'html_editor'})">open.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="tabs"><a href="javascript:usdlc.edit_source({value:'tabs.coffee',path:'../roaster/client/vc/html_editor/tabs.coffee',category:'html_editor'})">tabs.coffee</a> </span><span class="messages"><a href="javascript:usdlc.edit_source({value:'messages.coffee',path:'../roaster/client/vc/messages.coffee',category:'vc'})">messages.coffee</a> </span><span class="tab_view"><a href="javascript:usdlc.edit_source({value:'tab_view.coffee',path:'../roaster/client/vc/tab_view.coffee',category:'vc'})">tab_view.coffee</a> </span><span class="toolbar"><a href="javascript:usdlc.edit_source({value:'toolbar.coffee',path:'../roaster/client/vc/html_editor/toolbar.coffee',category:'html_editor'})">toolbar.coffee</a> </span><span class="codemirror"><a href="javascript:usdlc.edit_source({value:'codemirror.coffee',path:'../roaster/client/packages/codemirror.coffee',category:'packages'})">codemirror.coffee</a> </span><span class="ckeditor4"><a href="javascript:usdlc.edit_source({value:'ckeditor4.coffee',path:'../roaster/client/packages/ckeditor4.coffee',category:'packages'})">ckeditor4.coffee</a> </span><span class="codemirror5"><a href="javascript:usdlc.edit_source({value:'codemirror5.coffee',path:'../roaster/client/packages/codemirror5.coffee',category:'packages'})">codemirror5.coffee</a> </span><span class="coffee-script"><a href="javascript:usdlc.edit_source({value:'coffee-script.coffee',path:'../roaster/client/packages/coffee-script.coffee',category:'packages'})">coffee-script.coffee</a> </span><span class="scheduler"><a href="javascript:usdlc.edit_source({value:'scheduler.coffee',path:'../roaster/client/packages/dhtmlx/scheduler.coffee',category:'dhtmlx'})">scheduler.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.coffee',path:'../roaster/client/packages/bootstrap.coffee',category:'packages'})">bootstrap.coffee</a> </span><span class="codebird"><a href="javascript:usdlc.edit_source({value:'codebird.coffee',path:'../roaster/client/packages/codebird.coffee',category:'packages'})">codebird.coffee</a> </span></div>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc editor" vc="html_editor"&gt;&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @editor = @get_vc_for 'editor'
      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "HTML Editor View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
        "VC_-_Separation_of_Concerns/HTML_Editor_View/"+
        "HTML_View"

    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      return gwt.fail(err) if err
      ed = body.get_vc_for('editor').ed
      ed.setData "The rain in spain"
      process.nextTick -&gt;
        contents = ed.getData()
        if contents.indexOf("The rain in spain") is -1
          return gwt.fail('Contents incorrect')
        gwt.pass()
  setTimeout go, 4#000</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/html_editor/open.coffee',category:'html_editor'})">open.coffee</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="toolbar"><a href="javascript:usdlc.edit_source({value:'toolbar.coffee',path:'../roaster/client/vc/html_editor/toolbar.coffee',category:'html_editor'})">toolbar.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="drawers"><a href="javascript:usdlc.edit_source({value:'drawers.coffee',path:'../roaster/client/vc/drawers.coffee',category:'vc'})">drawers.coffee</a> </span><span class="popup_menu"><a href="javascript:usdlc.edit_source({value:'popup_menu.coffee',path:'../roaster/client/vc/popup_menu.coffee',category:'vc'})">popup_menu.coffee</a> </span><span class="file"><a href="javascript:usdlc.edit_source({value:'file.coffee',path:'../roaster/client/vc/html_editor/file.coffee',category:'html_editor'})">file.coffee</a> </span><span class="code_editor"><a href="javascript:usdlc.edit_source({value:'code_editor.coffee',path:'../roaster/client/vc/code_editor.coffee',category:'vc'})">code_editor.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h3>Code Editor View</h3>

<h4>Code View</h4>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Code Editor", -&gt; @page.test -&gt;
  go = -&gt;
    vc = require 'vc'
    vc document.body, vc: 'code_editor', (err, ed) -&gt;
      ed.load( "test.coffee", "if true then live_a_little()")
      
      #### Everything below is verification

      process.nextTick -&gt;
        contents = ed.editor.getValue()
        if contents.indexOf("live_a_little") is -1
          return gwt.fail('Contents incorrect')
        gwt.pass()
  setTimeout go, 4#000
 </pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a>&nbsp;</span><span class="roast"><a href="javascript:usdlc.edit_source({value:'roast.coffee',path:'../roaster/client/roast.coffee',category:'client'})">roast.coffee</a> </span><span class="Integrant"><a href="javascript:usdlc.edit_source({value:'Integrant.coffee',path:'../roaster/client/vc/Integrant.coffee',category:'vc'})">Integrant.coffee</a> </span><span class="internet"><a href="javascript:usdlc.edit_source({value:'internet.coffee',path:'../roaster/server/internet.coffee',category:'server'})">internet.coffee</a> </span><span class="Storage"><a href="javascript:usdlc.edit_source({value:'Storage.coffee',path:'../roaster/client/Storage.coffee',category:'client'})">Storage.coffee</a> </span></div>

<p><textarea readonly="readonly" source="true" type="gwt.coffee"></textarea></p>

<h4>HTML View</h4>

<pre title="html" type="html">
&lt;div class="vc editor" vc="code_editor"&gt;&lt;/div&gt;</pre>

<pre title="coffee" type="coffee">
try
  Integrant = require 'vc/Integrant'

  class Body extends Integrant
    init: (ready) -&gt;
      @editor = @get_vc_for 'editor'
      # do further initialisation requiring async access
      ready(err = null)

  module.exports = Body
catch</pre>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "HTML Editor View", -&gt; @page.test -&gt;
  go = -&gt;
    name = "/gen/usdlc2/Roaster_Client_Support/"+
        "VC_-_Separation_of_Concerns/Code_Editor_View/"+
        "HTML_View"

    vc = require 'vc'
    vc document.body, vc: name, (err, body) -&gt;
      return gwt.fail(err) if err
      ed = body.get_vc_for('editor')
      ed.load( "test.js", go.toString())
      process.nextTick -&gt;
        contents = ed.editor.getValue()
        if contents.indexOf("implement") is -1
          return gwt.fail('Contents incorrect')
        gwt.pass()
  setTimeout go, 4#000</pre>

<p> </p>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span><span class="code_editor"><a href="javascript:usdlc.edit_source({value:'code_editor.less',path:'../roaster/client/vc/code_editor.less',category:'vc'})">code_editor.less</a> </span><span class="html_editor"><a href="javascript:usdlc.edit_source({value:'html_editor.coffee',path:'../roaster/client/vc/html_editor.coffee',category:'vc'})">html_editor.coffee</a> </span><span class="open"><a href="javascript:usdlc.edit_source({value:'open.coffee',path:'../roaster/client/vc/html_editor/open.coffee',category:'html_editor'})">open.coffee</a> </span><span class="file"><a href="javascript:usdlc.edit_source({value:'file.coffee',path:'../roaster/client/vc/html_editor/file.coffee',category:'html_editor'})">file.coffee</a> </span></div>

<h3>DHTMLX Views</h3>

<h4>Scheduler View</h4>

<h5>Code View</h5>

<pre title="gwt.coffee" type="gwt.coffee">
&nbsp;</pre>

<div class="metadata Ref">Ref: <span class="Bridge"><a href="javascript:usdlc.bridge_editor()">Bridge</a> </span><span class="Play"><a href="javascript:usdlc.play()">Play</a> </span></div>

<h5>HTML View</h5>

<p>This component wraps the GPL version of DHTMLX scheduler.</p>

<pre title="gwt.coffee" type="gwt.coffee">
gwt.open_page "client/bootstrap.html"

gwt.add "Scheduler View", -&gt; @page.test -&gt;
  go = -&gt;
    picture = vc:'dhtmlx/scheduler', options:{}

    vc = require 'vc'
    vc picture, document.body, (err, schd) -&gt;
      return gwt.fail(err) if err
      process.nextTick -&gt;
  setTimeout go, 4#000</pre>

<div class="metadata Ref"><br />
<span class="Resource"><a href="javascript:usdlc.edit_source({value:'Resource.coffee',path:'../roaster/client/model/Resource.coffee',category:'model'})">Resource.coffee</a> </span><span class="File"><a href="javascript:usdlc.edit_source({value:'File.coffee',path:'../roaster/client/model/File.coffee',category:'model'})">File.coffee</a> </span><span class="file"><a href="javascript:usdlc.edit_source({value:'file.coffee',path:'../roaster/client/file.coffee',category:'client'})">file.coffee</a> </span><span class="loaders"><a href="javascript:usdlc.edit_source({value:'loaders.coffee',path:'../roaster/client/roast/loaders.coffee',category:'roast'})">loaders.coffee</a> </span><span class="roast"><a href="javascript:usdlc.edit_source({value:'roast.coffee',path:'../roaster/client/roast.coffee',category:'client'})">roast.coffee</a> </span><span class="read"><a href="javascript:usdlc.edit_source({value:'read.coffee',path:'../roaster/server/http/read.coffee',category:'http'})">read.coffee</a> </span><span class="index"><a href="javascript:usdlc.edit_source({value:'index.html',path:'../roaster/index.html',category:'roaster'})">index.html</a> </span><span class="save"><a href="javascript:usdlc.edit_source({value:'save.coffee',path:'../roaster/server/http/save.coffee',category:'http'})">save.coffee</a> </span><span class="dialog"><a href="javascript:usdlc.edit_source({value:'dialog.coffee',path:'../roaster/client/dialog.coffee',category:'client'})">dialog.coffee</a> </span><span class="respond"><a href="javascript:usdlc.edit_source({value:'respond.coffee',path:'../roaster/server/http/respond.coffee',category:'http'})">respond.coffee</a> </span><span class="files"><a href="javascript:usdlc.edit_source({value:'files.coffee',path:'../roaster/server/files.coffee',category:'server'})">files.coffee</a> </span><span class="Storage"><a href="javascript:usdlc.edit_source({value:'Storage.coffee',path:'../roaster/client/Storage.coffee',category:'client'})">Storage.coffee</a> </span><span class="init"><a href="javascript:usdlc.edit_source({value:'init.coffee',path:'../roaster/client/roast/init.coffee',category:'roast'})">init.coffee</a> </span><span class="bootstrap"><a href="javascript:usdlc.edit_source({value:'bootstrap.coffee',path:'../roaster/client/bootstrap.coffee',category:'client'})">bootstrap.coffee</a> </span><span class="internet"><a href="javascript:usdlc.edit_source({value:'internet.coffee',path:'../roaster/server/internet.coffee',category:'server'})">internet.coffee</a> </span><span class="vc"><a href="javascript:usdlc.edit_source({value:'vc.coffee',path:'../roaster/client/vc.coffee',category:'client'})">vc.coffee</a> </span><span class="codemirror"><a href="javascript:usdlc.edit_source({value:'codemirror.coffee',path:'../roaster/client/pkgs/codemirror.coffee',category:'pkgs'})">codemirror.coffee</a> </span><span class="app"><a href="javascript:usdlc.edit_source({value:'app.coffee',path:'../roaster/client/app.coffee',category:'client'})">app.coffee</a> </span><span class="base"><a href="javascript:usdlc.edit_source({value:'base.coffee',path:'../roaster/config/base.coffee',category:'config'})">base.coffee</a> </span></div>
</body>
<link href="document.css" rel="stylesheet" type="text/css" />
<link href="document.css" rel="stylesheet" type="text/css" /><br />
&nbsp;</html>
